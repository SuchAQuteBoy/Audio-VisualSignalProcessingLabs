<center>
<div>
<img src="https://raw.githubusercontent.com/SuchAQuteBoy/Pictures/master/HIT1.png" height="80"/>
</div>
<div>
<font size="10">实验报告</font>
</div>
<div>
<table border="0">
<tr>
<td align="left">题目</td>
<td align="left">图片色彩空间转换</td>
</tr>
<tr>
<td align="left">专业</td>
<td align="left">计算机科学与技术</td>
</tr>
<tr>
<td align="left">学号</td>
<td align="left">1160300329</td>
</tr>
<tr>
<td align="left">班级</td>
<td align="left">1603107</td>
</tr>
<tr>
<td align="left">学生</td>
<td align="left">黄海</td>
</tr>
<tr>
<td align="left">指导教师</td>
<td align="left">郑铁然</td>
</tr>
<tr>
<td align="left">实验地点</td>
<td align="left">G709</td>
</tr>
<tr>
<td align="left">实验日期</td>
<td align="left">11.25</td>
</tr>
</table>
</div>
<div>
<font size="5">计算机科学与技术学院</font>
</div>
</center>

<div STYLE="page-break-after: always;"></div>

<center>

# 一、BMP文件的基本解析

</center>

## 1.1 BMP文件头解析

BMP（全称Bitmap）是Windows操作系统中的标准图像文件格式，可以分成两类：设备有向量相关位图（DDB）和设备无向量关位图（DIB），使用非常广。它采用位映射存储格式，除了图像深度可选以外，不采用其他任何压缩，因此，BMP文件所占用的空间很大。BMP文件的图像深度可选lbit、4bit、8bit及24bit。BMP文件存储数据时，图像的扫描方式是按从左到右、从下到上的顺序。由于BMP文件格式是Windows环境中交换与图有关的数据的一种标准，因此在Windows环境中运行的图形图像软件都支持BMP图像格式。

在BMP文件中主要有四个部分
- 位图头文件数据结构
- 位图信息数据结构
- 调色板（可选 部分色彩位图需要）
- 位图数据
  
其中前三个部分为主要的数据头部。其中定义了该文件的大小，头大小和图片尺寸色彩等信息。对于头部的解析是第一步。

<center>

![](https://raw.githubusercontent.com/SuchAQuteBoy/Pictures/master/Audio-VisualSignalProcessing/Lab4/1.png)

</center>

这里我们主要使用长宽和颜色位数来确定图片文件头的大小 对于24和32色图片 **文件头稳定54个字节**

- 24色图片像素三个一组 分别表示（BGR）  
- 对于32色图片 四个字节一组

通过这个来确定像素数据开始的位置和大小

## 1.2 BMP数据的读取

数据的开始我们需要先去计算图片的尺寸 然后来进行计算 在例子中因为使用的是理想图片 所以固定的偏移了54字节 然后进行读取 将数据存入矩阵之中

<center>

![](https://raw.githubusercontent.com/SuchAQuteBoy/Pictures/master/Audio-VisualSignalProcessing/Lab4/2.png)

</center>

<center>

# 二、颜色空间的转换

</center>

## 2.1 RGB$\Rightarrow$HSI

我们使用几何方法来进行计算

$$
I = \frac{R+G+B}{\sqrt{3}}
$$

$$
S = 1 - \frac{3 \times min(R,G,B)}{R +G+B}
$$

$$
H = 
\left\{
    \begin{array}{ll}
        \theta, &G\ge B\\
        2\pi-\theta, &G<B
    \end{array}
\right.
$$
$$
\theta = arccos\frac{\frac{1}{2}\times((R-G)+(R-B))}{\sqrt{(R-G)^2+(R-B)(G-B)}}
$$

所以给出算法

<center>

![](https://raw.githubusercontent.com/SuchAQuteBoy/Pictures/master/Audio-VisualSignalProcessing/Lab4/3.png)

</center>

## 2.2 RGB$\Rightarrow$YIQ

转换关系如下

$$
\left\{
    \begin{array}{ll}
        Y=0.299R+0.587G+0.114B \\
        I=0.596R-0.275G-0.321B \\
        Q=0.212R-0.523G+0.311B
    \end{array}
\right.
$$

<center>

![](https://raw.githubusercontent.com/SuchAQuteBoy/Pictures/master/Audio-VisualSignalProcessing/Lab4/4.png)

</center>

## 2.3 RGB$\Rightarrow$YCbCr

转换关系如下

$$
\left\{
    \begin{array}{ll}
        Y=0.257R+0.564G+0.098B+16 \\
        Cb=-0.148R-0.291G-0.439B+128 \\
        Cr=0.439R-0.368G-0.071B+128
    \end{array}
\right.
$$

<center>

![](https://raw.githubusercontent.com/SuchAQuteBoy/Pictures/master/Audio-VisualSignalProcessing/Lab4/5.png)

</center>


<center>

# 三、 总结

</center>

## 3.1 请总结本次实验的收获

本次实验较为全面的了解了不同颜色空间的定义，也理解了各种空间之间的转换关系 同时对bmp文件的理解更加的深刻

## 3.2 请给出对本次实验内容的建议

希望能够在仅仅对数据进行转换的基础上 加入更改文件头的内容